<div class="notificationsTab">

  <div class="noti-clear">
    <h3 *ngIf="(!messages?.length && !friendRequests?.length)">
      No notifications!
    </h3>
  </div>

  <div class="tabsConts">

    <div class="conts">
      <div *ngIf="messages?.length" class="d-flex align-items-center justify-content-between mb-2">

        <h3 class="noti-heading">Messages</h3>
        <div class="clear-button">
          <app-button label="Mark messages read" size="xsmall" variant="highlight" (click)="markAllAsRead()">
          </app-button>
        </div>
      </div>

      <div class="tab-content" *ngIf="messages?.length">

        <div class="tab-pane">

          @for (msg of messages; track msg.roomId) {
          <div class="card mb-2 p-2 text-white">
            <div class="d-flex align-items-center w-100">

              <img [src]="msg.profilePicture || 'assets/images/profilePicPlaceHolder.jpg'" class="acount-icon" />

              <div class="userTextBar flex-grow">
                <strong>{{ msg.senderUsername }}</strong><br />
                <small>{{ msg.content }}</small><br />
                <small class="timestamp">{{ msg.timestamp | date:'short' }}</small>
              </div>

              <div class="friend-actions">
                <app-button label="Open" size="xsmall" variant="highlight" (click)="userClicked(msg.roomId)">
                </app-button>
              </div>

            </div>
          </div>
          }

        </div>
      </div>

      <div *ngIf="friendRequests?.length">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <h3 class="noti-heading">Friend Requests</h3>
          <div class="clear-button">
            <app-button label="Clear all requests" size="xsmall" variant="highlight" (click)="markRequestsAsRead()">
            </app-button>
          </div>
        </div>

        <div class="tab-content" *ngIf="safeFriendRequests.length > 0">

          <div class="tab-pane">

            @for (n of friendRequests; track n.fromUserId) {
            <div class="card mb-2 p-2 text-white">
              <div class="d-flex align-items-center">

                <img [src]="n.senderPicture" class="acount-icon" />

                <div class="userTextBar flex-grow">
                  <strong>{{ n.fromUsername }}</strong><br />

                  @if (n.status === 'PENDING') {
                  <small>Sent you a friend request</small>
                  }
                  @if (n.status === 'ACCEPTED') {
                  <small>accepted your friend request</small>
                  }
                  @if (n.status === 'DECLINED') {
                  <small>declined your friend request</small>
                  }
                </div>

                @if (n.status === 'PENDING') {
                <div class="actions">
                  <app-button label="Accept" size="xsmall" variant="highlight"
                    (click)="acceptRequest(n.fromUserId); clearRequest(n.fromUserId)">
                  </app-button>
                  <app-button label="Decline" size="xsmall"
                    (click)="declineRequest(n.fromUserId); clearRequest(n.fromUserId)">
                  </app-button>
                </div>
                }

                @if (n.status === 'ACCEPTED' || n.status === 'DECLINED') {
                <div class="friend-actions">
                  <app-button label="Clear" size="xsmall" variant="highlight" (click)="clearRequest(n.fromUserId)">
                  </app-button>
                </div>
                }

              </div>
            </div>
            }

          </div>
        </div>

      </div>
    </div>
  </div>
</div>