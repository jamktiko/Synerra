<div class="profile-header-container">
  @if (user) {
  <div class="header-content">
    <!-- Avatar Section -->
    <div class="avatar-section">
      <div class="avatar-wrapper">
        <img [src]="user.ProfilePicture || 'assets/images/profilePicPlaceHolder.jpg'" alt="Profile picture"
          class="avatar" />
      </div>
    </div>

    <!-- User Info Section -->
    <div class="user-info-section">
      <div class="user-main-info">
        <h1 class="username">{{ user.Username }}</h1>

        @if (isFriend) {
        <span class="friend-badge">
          Friend
          <img src="assets/svg/friend.svg" alt="friends" class="profilesvg" />
        </span>
        }

        <div class="joined-date">
          <span>Joined:</span>
          <span class="date">{{ ((user.CreatedAt ?? 0) * 1000) | date:'dd/MM/yyyy' }}</span>
        </div>
      </div>

      <!-- Description -->
      <div class="description-section">
        <p class="description" [class.expanded]="showFullDescription">
          {{ user.Bio || 'No description yet.' }}
        </p>

        @if (user.Bio && user.Bio.length > 150) {
        <button class="show-more-btn" (click)="toggleDescription()">
          {{ showFullDescription ? 'show less' : 'show more' }}
        </button>
        }
      </div>
    </div>

    <!-- Action Buttons Section -->
    <div class="actions-section">
      @if (isOwnProfile) {
      <div class="action-buttons">
        <button class="social-badge" (click)="onEditProfile()" aria-label="Edit profile" title="Edit profile">
          <img src="assets/svg/edit-icon.svg" alt="Edit" class="profilesvg" />
        </button>
      </div>
      } @else {
      <div class="action-buttons">
        @if (!isFriend) {
        <button class="social-badge" (click)="addFriend(user)" [disabled]="alreadySent" aria-label="Add friend">
          {{ alreadySent ? 'Request Sent' : 'Add Friend' }}
        </button>
        }

        @if (isFriend) {
        <button class="social-badge" (click)="removeFriend(user)" aria-label="Remove friend">
          {{ confirmingRemoval === user.UserId ? 'Confirm' : 'Unfriend' }}
        </button>
        }

        <button class="social-badge" (click)="userClicked(user.UserId)" aria-label="Start chat" title="Start chat">
          <img src="/assets/svg/NoMessage.svg" alt="addfriend" class="profilesvg">
        </button>

        <button class="social-badge" (click)="openReputationModal()" aria-label="Add Reputation"
          title="Give Reputation">
          REP
        </button>
      </div>
      }
    </div>

    <!-- Right Section: Social Badge -->
  </div>
  }

</div>

@if (showReputationModal) {
<div class="modal-backdrop">
  <div class="modal-window">
    <div class="rep-slider-group">

      <!-- Mentality -->
      <label class="rep-label">Mentality: {{ repMentality }}</label>
      <input type="range" min="1" max="100" [(ngModel)]="repMentality" class="rep-slider" />

      <!-- Comms -->
      <label class="rep-label">Comms: {{ repComms }}</label>
      <input type="range" min="1" max="100" [(ngModel)]="repComms" class="rep-slider" />

      <!-- Teamwork -->
      <label class="rep-label">Teamwork: {{ repTeamwork }}</label>
      <input type="range" min="1" max="100" [(ngModel)]="repTeamwork" class="rep-slider" />

    </div>

    <div class="modal-actions">
      <app-button (click)="closeReputationModal()" label="Close" variant="highlight" size="xsmall" [fullWidth]="false"
        align="center">
      </app-button>

      <app-button (click)="submitReputation()" label="Submit" variant="highlight" size="xsmall" [fullWidth]="false"
        align="center">
      </app-button>
    </div>
  </div>
</div>
}