<div class="filters-container">
  <h2>Find Your Teammates</h2>

  <div class="search-wrapper">
    <img src="assets/svg/Search_icon.svg" alt="Search" class="search-icon" />
    <input type="search" name="playerSearch" [formControl]="searchControl" placeholder="Search by username"
      autocomplete="off" spellcheck="false" inputmode="search" class="search-input" aria-label="Search by username" />
  </div>

  <div class="filters" role="region" aria-label="Filters">

    <!-- STATUS -->
    <div class="checkbox-collapsible">
      <!-- PÄIVITETTY: Teksti on nyt dynaaminen -->
      <button type="button" (click)="toggleDropdown('status')" [attr.aria-expanded]="openDropdown === 'status'"
        aria-haspopup="true">
        {{ selectedStatusLabel }} ▾
      </button>

      <div *ngIf="openDropdown === 'status'" class="checkbox-list animate-fade" role="menu">
        <label class="checkbox-item" (click)="$event.stopPropagation()">
          <input type="radio" name="status" (change)="onStatusChange('')" [checked]="!filters.Status" />
          <span class="item-text">Any status</span>
        </label>

        <label class="checkbox-item" (click)="$event.stopPropagation()">
          <input type="radio" name="status" (change)="onStatusChange('online')"
            [checked]="filters.Status === 'online'" />
          <span class="item-text">Online</span>
        </label>

        <label class="checkbox-item" (click)="$event.stopPropagation()">
          <input type="radio" name="status" (change)="onStatusChange('offline')"
            [checked]="filters.Status === 'offline'" />
          <span class="item-text">Offline</span>
        </label>
      </div>
    </div>

    <!-- KIELET -->
    <div class="checkbox-collapsible">
      <button type="button" (click)="toggleDropdown('languages')" [attr.aria-expanded]="openDropdown === 'languages'"
        aria-haspopup="true">
        Languages ▾
      </button>

      <div *ngIf="openDropdown === 'languages'" class="checkbox-list animate-fade" role="menu"
        (click)="$event.stopPropagation()">
        <label *ngFor="let lang of availableLanguages" class="checkbox-item">
          <input type="checkbox" [value]="lang.value" (change)="onLanguageToggle($event, lang.value)"
            [checked]="filters.languages.includes(lang.value)" />
          <span class="item-text">{{ lang.label }}</span>
        </label>
      </div>
    </div>

    <!-- PELIT -->
    <div class="checkbox-collapsible">
      <button type="button" (click)="toggleDropdown('games')" [attr.aria-expanded]="openDropdown === 'games'"
        aria-haspopup="true">
        Games ▾
      </button>

      <div *ngIf="openDropdown === 'games'" class="checkbox-list animate-fade" role="menu"
        (click)="$event.stopPropagation()">
        <label *ngFor="let game of games" class="checkbox-item">
          <input type="checkbox" [value]="game.PK.replace('GAME#','')"
            (change)="onGameToggle($event, game.PK.replace('GAME#','') || '')"
            [checked]="filters.games.includes(game.PK.replace('GAME#','') || '')" />
          <span class="item-text">{{ game.Name }}</span>
          <span class="item-count">({{ game.Popularity || 0 }})</span>
        </label>
      </div>
    </div>

    <div class="checkbox-collapsible">
      <button type="button" (click)="toggleDropdown('playstyle')" [attr.aria-expanded]="openDropdown === 'playstyle'"
        aria-haspopup="true">
        Playstyle ▾
      </button>

      <div *ngIf="openDropdown === 'playstyle'" class="checkbox-list animate-fade" role="menu"
        (click)="$event.stopPropagation()">
        <label class="checkbox-item">
          <input type="radio" name="playstyle" value="" (change)="onPlaystyleChange($event)"
            [checked]="!filters.playstyle" />
          <span class="item-text">Any</span>
        </label>

        <label *ngFor="let style of availablePlaystyles" class="checkbox-item">
          <input type="radio" name="playstyle" [value]="style" (change)="onPlaystyleChange($event)"
            [checked]="filters.playstyle === style" />
          <span class="item-text">{{ style }}</span>
        </label>
      </div>
    </div>

    <div class="checkbox-collapsible">
      <button type="button" (click)="toggleDropdown('platform')" [attr.aria-expanded]="openDropdown === 'platform'"
        aria-haspopup="true">
        Platforms ▾
      </button>

      <div *ngIf="openDropdown === 'platform'" class="checkbox-list animate-fade" role="menu"
        (click)="$event.stopPropagation()">
        <label *ngFor="let platform of availablePlatforms" class="checkbox-item">
          <input type="checkbox" [value]="platform" (change)="onPlatformToggle($event, platform)"
            [checked]="filters.platform.includes(platform)" />
          <span class="item-text">{{ platform }}</span>
        </label>
      </div>
    </div>

  </div>
</div>